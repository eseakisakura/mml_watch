　　■ PowerShell - Guitar Arpeggio MML Generator 


　-- 当テキストは、構造化エディタで組まれてます。

　スクリプト側も構造化エディタ対応です。--


 
　　□ 概要 


　　ギターのフレットの押さえをMML Chordへ変換し、
　ギターアルペジオを、マルチトラックで再現するものです。
　
　ppmck,NSDlib,P.M.D,Fmp7,Sakura_mmlに対応します。
　タイを生かした串抜きの効果を、試聴できるのが特徴です。


　アルペジオを先に打ってから、コードアサインするような使い方を想定してます。


 
　　□ 注意点について 


　・Fmp7,sakura_mmlは、試聴できません。


　・g+でなくg#のような出力も可ですが、コンパイラによっては受け付けません。

　・もし起動できない場合は、
　　scriptフォルダにあるarp_gene.xml環境ファイルを削除して下さい。

　　初期設定と同じになります。


 
　　□ 基本設定 - クイックスタート 


　まず、環境設定から始めます。



　1.　arp_geneを起動し、オプションから settingをクリック、
　　　環境設定が立ち上がります。


　2.　各リストボックスに、必要となるファイル、
　　　プログラムを登録します。

　　　bin,player,dos,editorタブに、順に登録します。
　　　(PMDを64bitOSで使用の場合、x64にチェックを入れて下さい。)


　3.　アルペジオのロールから、5313 1313のような数字を選びます。


　4.　再生ボタンを押して、アルペジオの音が出れば基本的な設定は完了です。
　　　もし音が出ない場合は、オプションから、再生できるプレイヤーの選択をしてみて下さい。


 	
　　□ 各機能の説明 

	 
　　・メニュー 

　・setting

　　環境設定です。
　　各リストボックスに、ファイルドロップで登録します。


　・オクターブ

　試聴時のオクターブ指定です。

　・MML

　クリップボードへTextBoxをコピーします。


　・Advanced(上級者向け)

　試聴する音を変えるときに使用します。

　"mck_header"は、ppmck の試聴mmlです。
　"nsd_header"は、NSDlib の試聴mmlです。
　"pmd_header"は、PMD の試聴mmlです。



 
　　・本体パネルの説明 


　・コードセレクト

　キー指定 [A-G]、コード選択 [M7,m7,..]、ルート選択[6-4]をすると、
　ギターのフレットナンバーを表示します。


　・オープンコードチェックボックス

　オープンコードを使用する場合、チェックを入れます。

　オープンポジションがあれば、オレンジランプ、
　なければ、ブルーランプとなりクローズドポジションが選択されます。




　・フレットセッティング

　ギターのフレットナンバーの出力と、相対するMMLコードが出力されます。

　黒鍵はそれぞれ、フラット[-]かシャープ[+,#]の選択ができます。




　・MMLアルペジオ

　アルペジオナンバーを入力します。
　許される文字は[6-1] [^] [r] のみです。

　・再生ボタン

　試聴ボタンです。
　(音が出ない場合、プレイヤーアサインを確認して下さい。)

　各TextBoxにフォーカスあらば、[F12キー]を叩いても再生します。


　・ストップボタン

　音を止めます。nsfplay2.3,winamp用。
　FMPMDでは、ストップコマンドと相性が悪いため押しても変化しません。

　各TextBoxにフォーカスあらば、[F10キー]でも止まります。




　・トラックヘッダ

　各コンパイラのトラックヘッダを選択します。
　接頭辞を追加する場合、1  2  15  16 のように、空白を二文字入れて下さい。


　・下部ウィンドウ

　分散和音が出力されます。コピペなどでエディタへ流し込んで下さい。
　　

  
　　□ Tips 


	
　・アルペジオのコツ 

　ベースとなるルート音を最初に鳴らし、
　続いて123弦による分散和音が基本スタイルとなります。


　rを差し込むことで、タイを全ミュートし、
　鳴りっぱなし感を一旦仕切り直すのも一つの手です。



 
　・コード外の音が使いたい 

　コード外の音が使いたい場合、
　フレットナンバーの数字を直接編集することで、MMLコードを変更できます。

　　0 3 2 0 1 0 -> 0 3 2 0 1 1
　　"eceg`c[`e] -> "eceg`c[`f]



 
　・各トラックの後ろに、次の分散コードの出力をつなげたい 

　単体ではできません。
　Editor側の矩形選択を使えば何とかなります。

　Meryの場合、Alt+ カーソルか、Alt+ マウスで矩形選択のち、
　つなげたい場所でペーストすれば、後ろへ流し込めます。


  
　　□ 仕様について 


　セーブ機能はありません。
　Arpeggioボックスから数値を拾って、エディタなどで保存して下さい。

　[arp_geneは、必ずreset状態で起動するためです。]



 
　　□謝辞 / 参照リンク 


　コードポジションは、以下のページ様を参照しています。

　http://www9.ocn.ne.jp/~knatsu/chords/chords.html
　http://www.ishibashi.co.jp/academic/Chord_Guitar/C.htm
　ドミナント9th - 8monji-guitar.com

　http://www.naru-gakki.com/guitar-opentuning/
　http://guitar-hakase.com/tuning/
　http://www.aki-f.com/kouza/b_kouza/kouza5/kouza5_2.htm
 
　　□ 免責事項 /使用条件 /著作権など 


　・Apacheライセンス2.0を適用して下さい

　・当スクリプト群を使用して何らかの問題が起こっても、責任を要求しないこと

　・再配布する際は、当ドキュメントファイルを維持して下さい


　= 黄白紅藍玄 =
　https://twitter.com/huangbaihonglan

　Copyright(C) 04coreworks
　https://github.com/eseakisakura


　'19	3 14		F2、F12キーで試聴できるようにした
	5 18		M7b5を追加した
	7 5		試聴mmlをheaderフォルダから読むようにした
	9 14		m7b5,11のポジション間違い修正
	12 5		if("") -> if('')と直した
	7		win10対応のため、eventスクリプトブロック内に$script:を挿入した
			win10対応のため、hash,xmlの左辺、script:スコープを見直した
			funcの引数を$x= $script:^^^として、funcへローカル登録とした

　'20	1 12		Advancedで試聴mmlを呼び出せるようにした
	31		GUI対応のエラー出力にした
	2 7		$box_apeg.SelectedTextの最適化をした
			Undo機能追加
	2 27		スタンドアロンにした、環境設定を自前でできるようにした
	4 19		6sus2を追加した

	7 25		menu_buildの失敗点、ハッシュの初期化、メニューのリセットを修正
	8 31		トレイアイコンを付けた
	11 26	HelpファイルをStedで読めるようにした

   '21	1 21		trayicon非表示機能つけた
			PS7ため、ps1と読み込みfileはutf8(appためbom有り)とした(mml出入力はshiftJISのまま)
			mmlライタをcommon.ps1へ移動した(utf8 bom無しへ対応するため)
	2 1		[cat]ファイル読み込み回数をできるだけ減らした
	3 6		compiler周りの読み込み方を変えた

	6 25		プレイヤーオープンを実装した

	11 25	初動からの安定性を上げた、Arpchange_value周りの最適化
 
